(()=>{const A="https://hansel-cottage.onrender.com";function c(h){const s=document.createElement("style");s.textContent="#hc-b{position:fixed;bottom:20px;right:20px;background:#4a5568;color:#fff;border-radius:50%;width:56px;height:56px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:24px;box-shadow:0 4px 8px rgba(0,0,0,.2);z-index:999999}#hc-w{position:fixed;bottom:84px;right:20px;width:320px;max-height:420px;background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.3);display:none;flex-direction:column;overflow:hidden;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;z-index:999999}#hc-h{background:#4a5568;color:#fff;padding:10px;font-weight:700}#hc-m{flex:1;padding:10px;overflow-y:auto;font-size:14px}#hc-i{display:flex;border-top:1px solid #ddd}#hc-t{flex:1;border:0;padding:8px;font-size:14px;outline:0}#hc-s{background:#4a5568;color:#fff;border:0;padding:0 14px;cursor:pointer;font-size:14px}",document.head.appendChild(s);const b=document.createElement("div");b.id="hc-b",b.textContent="ðŸ’¬",document.body.appendChild(b);const w=document.createElement("div");w.id="hc-w",w.innerHTML='<div id="hc-h">Hansel Cottage</div><div id="hc-m"></div><div id="hc-i"><input id="hc-t" placeholder="Ask about availability..."><button id="hc-s">Send</button></div>',document.body.appendChild(w);const m=w.querySelector("#hc-m"),t=w.querySelector("#hc-t"),S=w.querySelector("#hc-s");function a(e,n){const d=document.createElement("div");d.innerHTML=`<strong>${e}:</strong> ${n}`,m.appendChild(d),m.scrollTop=m.scrollHeight}async function g(){const e=t.value.trim();if(!e)return;a("You",e),t.value="";try{let n=e;const D=/\b(?:from|start|check[- ]?in)\s+(\d{4}-\d{2}-\d{2}).*?(?:for|nights?)\s+(\d+)/i.exec(e);if(D){const[,r,i]=D;const o=await fetch(A+"/api/availability?from="+encodeURIComponent(r)+"&nights="+encodeURIComponent(i));const l=await o.json();if(l&&typeof l.available=="boolean"){n=l.available?`Yes, those dates appear available for ${i} night(s).`:`Sorry, those dates look unavailable. Suggestions: ${(l.suggestions||[]).map(x=>x.from).slice(0,3).join(", ")||"try nearby dates."}`}}const R=await fetch(A+"/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n})});const p=await R.json();a("Bot",p.answer||"Sorry, I didn't understand.");}catch{a("Bot","âš ï¸ Error contacting server.")}}b.onclick=()=>{w.style.display=w.style.display==="flex"?"none":"flex",w.style.display==="flex"&&t.focus()},S.onclick=g,t.addEventListener("keypress",e=>{e.key==="Enter"&&g()});}if(!window._hcWidget){window._hcWidget=1;const o=(document.currentScript&&document.currentScript.dataset.api)||A;c(o)}})();
